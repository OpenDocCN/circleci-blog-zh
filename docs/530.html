<html>
<head>
<title>Run a Postman collection using the Newman orb | CircleCI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>使用Newman orb | CircleCI运行邮差收集</h1>
<blockquote>原文：<a href="https://circleci.com/blog/set-up-a-circleci-pipeline-to-run-a-postman-collection-using-the-newman-orb/#2019-05-13T08:00:00-07:00">https://circleci.com/blog/set-up-a-circleci-pipeline-to-run-a-postman-collection-using-the-newman-orb/#2019-05-13T08:00:00-07:00</a></blockquote><div><div class="post-content col-xs-12 col-md-10 col-lg-8">
        

        <p>软件业正越来越趋向于API优先的世界。今天构建的大型软件系统是由API组成的。<a href="https://www.getpostman.com/" target="_blank" rel="noreferrer noopener"> Postman </a>已经成为软件开发人员和测试人员设计、测试和发布API的可信工具。全球超过600万开发人员和20万以上的组织在其API开发生命周期的每个阶段都使用Postman。</p>

<p>Postman中的工作流围绕着收藏。集合是一组HTTP请求，它们可以有自己的测试、响应示例和文档。您可以直接从集合中生成API文档。保存的响应示例构成了为API创建模拟服务器的基础。您可以通过团队工作区在所有这些方面进行协作。</p>

<p>Postman也有能力执行这些集合。运行集合会逐个触发集合中的所有请求。您还可以编写脚本来断言响应、控制执行顺序，以及在一次运行中在请求之间传输数据。当您想要测试API、对API工作流执行端到端测试和/或对API进行健康检查时，这是非常有用的。你说吧。</p>

<h2>在CI环境中执行集合</h2>
<p>Postman的一个非常常见的用例是在CI管道中运行集合。团队对他们的服务运行契约测试、端到端测试、安全检查或基础设施检查，作为他们构建或发布管道的一部分。这就是Newman命令行集合运行器有用的地方。</p>

<p>Newman是一个Node.js应用程序，可以从本地文件系统或远程URL运行一个集合。纽曼还提供了多种报告选项。您可以生成json、xml或html输出形式的收集运行报告。当您将Newman与CI环境集成时，您可以根据您的API是否按预期执行来控制您的构建阶段。</p>

<h2>一个orb来帮助简化您的收集运行</h2>
<p>虽然Newman是作为Docker容器发布的，但是设置这些构建阶段可能非常耗时。借助CircleCI的<a href="https://circleci.com/developer/orbs/orb/postman/newman" target="_blank" rel="noreferrer noopener"> Newman orb </a>,我们已经构建了一个现成的集成，您只需进行一项配置，就可以在CircleCI管道中触发收集运行。</p>

<p>orb将负责设置Newman，执行您在配置中提到的集合，并将运行报告存储在适当的位置。</p>

<h2>配置orb</h2>
<p>Newman orb公开了可以在CircleCI配置中使用的<code>newman/newman-run</code>命令。您可以将您的集合从Postman导出为JSON并保存在您的存储库中，或者您可以使用您的集合ID和API键直接调用Postman API，并对最新版本的集合运行Newman。</p>

<p>假设您已经将您的收集文件导出到存储库根目录下的<code>./collection.json</code>,那么您的CircleCI配置应该是这样的:</p>

<pre><code class="language-yaml">version: 2.1
orbs:
  newman: postman/newman@0.0.2
jobs:
  newman-collection-run:
    executor: newman/postman-newman-docker
    steps:
      - checkout
      - newman/newman-run:
          collection: ./collection.json
</code></pre>

<p><code>newman/newman-run</code>命令接受许多传递给Newman的参数。以下是您应该知道的一些重要参数:</p>
<ul>
  <li><code>collection</code>:如上例所示，这是唯一需要的参数。它采用一个指向集合的JSON文件的路径或一个可以访问集合的URL。</li>
  <li><code>environment</code>:这需要一个从Postman导出的环境的路径，或者一个环境的URL。</li>
  <li><code>iteration-data</code>:如果您需要在采集运行中使用CSV文件中的外部数据，此参数将获取CSV文件的文件路径或URL。</li>
  <li><code>folder</code>:要在收藏中运行的文件夹的名称。当您想要将收集运行范围扩大到收集中的特定文件夹时，可以使用此选项。</li>
</ul>

<p>除此之外，你可以在<a href="https://circleci.com/developer/orbs/orb/postman/newman"> orb的文档页面</a>上查看所有被接受的参数。</p>

<h2>概括起来</h2>
<p>将CircleCI的强大功能与Postman和Postman API结合起来，您可以为您的APIOps和API测试构建完美的工作流。我们希望这个orb能够帮助您在API自动化之旅中走得更远。</p>

<p>在我们将于2019年5月14日上午10:00 PST/18:00 UTC举行的网络研讨会“使用CircleCI和Postman简化端到端API开发”期间，了解更多关于CircleCI和Postman的信息。在这里报名<a href="https://www2.circleci.com/CircleCI-Postman-Orbs-Webinar.html">。</a></p>



        
          
          
        
      </div>
    </div>    
</body>
</html>