<html>
<head>
<title>Why Developers Are Moving to Yarn - CircleCI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>为什么开发商要转向Yarn - CircleCI</h1>
<blockquote>原文：<a href="https://circleci.com/blog/why-are-developers-moving-to-yarn/#2017-01-18T03:30:00-08:00">https://circleci.com/blog/why-are-developers-moving-to-yarn/#2017-01-18T03:30:00-08:00</a></blockquote><div><div class="post-content col-xs-12 col-md-10 col-lg-8">
        
          <p class="italic"><strong>来自出版商的说明:</strong>您已经找到了我们的一些旧内容，这些内容可能已经过时和/或不正确。尝试在<a href="https://circleci.com/docs/" target="_blank">我们的文档</a>或<a href="https://circleci.com/blog/">博客</a>中搜索最新信息。</p>
          <hr/>
        

        <p>随着Npm@5和NodeJS V8的发布，下面的一些信息已经过时。</p>

<p>JavaScript世界每秒都在变化。说过去一年发生了很多事情是轻描淡写。这些变化包括<a href="https://blog.thoughtram.io/angular/2016/09/15/angular-2-final-is-out.html"> Angular2发布</a>，<a href="https://nodejs.org/en/blog/release/v7.0.0/"> Node.js 7.0.0发布</a>，以及<a href="http://www.ecma-international.org/ecma-262/7.0/index.html"> ECMAScript 2016 (ES7) </a>的特性集最终确定。2016年10月，脸书、Exponent、谷歌和Tilde发布了一个意想不到的东西，一个被他们称为<a href="https://yarnpkg.com/">纱</a>的<a href="https://github.com/npm/npm"> npm </a>替代品。</p>



<h2>Npm问题和纱线解决方案</h2>

<p>Yarn不是npm的一个分支，而是它的一个重新想象。大型项目——比如脸书和谷歌的项目——放大了开发人员在使用<code>npm</code>时可能面临的问题。</p>

<h3>国家预防机制的潜在问题</h3>

<ul>
  <li>嵌套依赖关系(在npm 3中已修复)</li>
  <li>程序包的串行安装</li>
  <li>单包注册表(npmjs.com有没有为你倒下过？)</li>
  <li>需要网络来安装软件包(虽然我们可以创建一个临时的缓存)</li>
  <li>允许包在安装时运行代码(不利于安全)</li>
  <li>不确定的包状态(您不能确定项目的所有副本都将使用相同的包版本)</li>
</ul>

<h3>纱线解决方案</h3>

<ul>
  <li>多个注册表——Yarn从<code>npmjs.com</code>和<a href="https://bower.io/"> Bower </a>读取并安装包。如果其中一个发生故障，您的项目可以继续在CI中构建，不会出现问题</li>
  <li>平面依赖结构——更简单的依赖解析意味着纱线完成得更快，并且可以被告知使用特定包的单一版本，这使用更少的磁盘空间</li>
  <li>自动重试-单个网络请求失败不会导致安装失败。失败时会重试请求，从而减少由于临时网络问题而导致的红色构建</li>
  <li>并行下载——Yarn可以并行下载包，减少构建运行的时间</li>
  <li>与npm完全兼容-从npm转换到纱线是一个无摩擦的过程</li>
  <li><code>yarn.lock</code> -将依赖关系锁定到特定版本，类似于Ruby世界中的Gemfile.lock</li>
</ul>

<h3>纱线锁</h3>

<p>Yarn引入了一个锁文件<code>yarn.lock</code>，用来管理JavaScript包。对于团队工作的开发人员来说，这可能是Yarn最有用的特性。在<code>package.json</code>中，包版本可以被指定为一个范围，或者根本没有版本。这可能会导致一个问题，即同一个团队的不同开发人员使用同一个包的不同版本。任何接受过CI培训的工程师都知道，用完全相同的依赖关系复制一个环境的能力，对于有效的调试和新团队成员的加入是至关重要的。Yarn从包管理器如<a href="http://bundler.io/"> Bundler </a>那里借用，创建了一个<code>yarn.lock</code>文件，记录你在项目中使用的每个包的确切版本。将这个锁文件提交到您的VCS可以确保所有从事该项目的开发人员，如果他们使用Yarn，将会使用每个包的相同版本。</p>

<h2>在圈圈上使用纱线</h2>

<p>从npm切换到Yarn是没有痛苦的，因为它们是兼容的。我们第一次写关于Yarn的文章是在<a href="https://circleci.com/blog/install-and-use-yarn-the-npm-replacement-on-circleci/">12月</a>，在那里我们展示了下载和安装Yarn用于您的构建的最佳方式。从那以后，我们继续展示我们对Yarn的支持:Yarn现在已经预装在我们的<a href="https://circleci.com/docs/1.0/build-image-trusty/#yarn"> CircleCI Ubuntu 14.04(可信)映像</a>中。通过简单地使用<code>yarn</code>命令，Yarn可以像您的本地环境一样在CircleCI上使用。缓存说明可在我们的<a href="https://circleci.com/docs/1.0/yarn/">纱线文档</a>中找到。</p>

<h2>npm至纱线备忘单</h2>

<table class="cci-blue-theme">
	<tr>
		<th class="s0" dir="ltr">npm</th>
		<th class="s0" dir="ltr">故事</th>
	</tr>
	<tr>
		<td>npm安装</td>
		<td>故事</td>
	</tr>
	<tr>
		<td colspan="2">-从package.json安装项目依赖项</td>
	</tr>
	<tr>
		<td>npm安装[包]</td>
		<td>不适用的</td>
	</tr>
	<tr>
		<td colspan="2">-安装特定的包，但不将其作为依赖项保存在package.json中</td>
	</tr>
	<tr>
		<td>npm安装-保存[包]</td>
		<td>纱线添加[包装]</td>
	</tr>
	<tr>
		<td colspan="2">-安装一个包，并将其作为依赖项保存在package.json中</td>
	</tr>
	<tr>
		<td>npm安装-保存-开发[包]</td>
		<td>纱线添加[包装] [ - dev/-D]</td>
	</tr>
	<tr>
		<td colspan="2">-安装一个包，并将其专门作为开发依赖项保存在package.json中</td>
	</tr>
	<tr>
		<td>不适用的</td>
		<td>纱线添加[包装] [ - peer/-P]</td>
	</tr>
	<tr>
		<td colspan="2">-安装一个包并将其保存在package.json中，专门作为一个Yarn对等依赖项</td>
	</tr>
	<tr>
		<td>npm安装-保存-可选[软件包]</td>
		<td>纱线添加[包装] [ -可选/-O]</td>
	</tr>
	<tr>
		<td colspan="2">-安装一个包，并将其保存在package.json中，作为可选的依赖项</td>
	</tr>
	<tr>
		<td>npm安装-保存-精确[包]</td>
		<td>纱线添加[包装] [ -精确/-E]</td>
	</tr>
	<tr>
		<td colspan="2">-安装软件包的特定版本，而不是安装最新版本的默认行为</td>
	</tr>
	<tr>
		<td>不适用的</td>
		<td>纱线添加[包装] [ -颚化符/-T]</td>
	</tr>
	<tr>
		<td class="s3" dir="ltr" colspan="2">-安装具有指定主要版本的软件包的最新次要版本(即yarn add foo@1.2.3 -T将安装与1.2.x匹配的最新版本)</td>
	</tr>
	<tr>
		<td>npm安装-全局[软件包]</td>
		<td>纱线全局添加[包]</td>
	</tr>
	<tr>
		<td colspan="2">-在您的本地计算机上全局安装一个包，通常用于开发人员工具</td>
	</tr>
	<tr>
		<td>npm重建</td>
		<td>纱线安装力</td>
	</tr>
	<tr>
		<td colspan="2">-重建所有软件包，即使已经下载</td>
	</tr>
	<tr>
		<td>npm卸载[软件包]</td>
		<td>不适用的</td>
	</tr>
	<tr>
		<td colspan="2">-卸载软件包，但不将其从package.json中删除</td>
	</tr>
	<tr>
		<td>npm卸载-保存[包]</td>
		<td>纱线去除器[包装]</td>
	</tr>
	<tr>
		<td colspan="2">-卸载一个包并将其从package.json中删除(不考虑Yarn中的依赖类型)</td>
	</tr>
	<tr>
		<td>npm卸载-保存-开发[包]</td>
		<td>不适用的</td>
	</tr>
	<tr>
		<td colspan="2">-卸载软件包，并将其作为开发依赖项从package.json中移除</td>
	</tr>
	<tr>
		<td>npm卸载-保存-可选[软件包]</td>
		<td>不适用的</td>
	</tr>
	<tr>
		<td colspan="2">-卸载软件包，并将其作为可选依赖项从package.json中删除</td>
	</tr>
	<tr>
		<td>rm -rf节点模块和npm安装</td>
		<td>纱线升级</td>
	</tr>
	<tr>
		<td colspan="2">-将软件包升级到最新版本</td>
	</tr>
</table>

<h2>摘要</h2>

<p>Yarn解决了诸如不确定的依赖性、网络问题/npmjs关闭以及并行下载等问题，以便提供比npm更大的价值。然而，新政治机制是自身成功的受害者。随着越来越多的人转向Yarn和其他注册中心，npm服务器将变得更加可用。两个包经理都很棒，最终会互相提高。</p>

<p><strong> <em>好玩的事实:</em> </strong> <em>在你的本地机器上，npm可以安装Yarn！<code>npm install --global yarn</code>。纱线团队不推荐这种安装方法。</em></p>


        
          
          
        
      </div>
    </div>    
</body>
</html>