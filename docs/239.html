<html>
<head>
<title>Automatically deploy private Docker images to Amazon ECR - CircleCI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>自动将私有Docker映像部署到Amazon ECR - CircleCI</h1>
<blockquote>原文：<a href="https://circleci.com/blog/deploy-private-docker-image-amazon-ecr/#2020-03-05T23:00:00-08:00">https://circleci.com/blog/deploy-private-docker-image-amazon-ecr/#2020-03-05T23:00:00-08:00</a></blockquote><div><div class="post-content col-xs-12 col-md-10 col-lg-8">
        

        <p>本文介绍了如何使用CircleCI orbs构建生产级Docker映像并将其推送到Amazon弹性容器注册中心(ECR)进行存储。</p>

<h2>什么是亚马逊ECR？</h2>

<p>亚马逊ECR是一个完全托管的私有Docker容器注册中心，开发者可以很容易地存储、管理和部署Docker容器映像。亚马逊ECR与亚马逊弹性容器服务<a href="https://aws.amazon.com/ecs/" target="_blank" rel="noreferrer noopener">亚马逊ECSe </a>和亚马逊弹性Kubernetes服务<a href="https://aws.amazon.com/eks/" target="_blank" rel="noreferrer noopener">亚马逊EKS </a>无缝集成。亚马逊ECR也可以和其他云厂商一起使用。</p>

<h2>为什么要使用像Amazon ECR这样的私有Docker注册中心？</h2>

<ul>
  <li>在许多情况下，分离开发、测试和生产注册是可取的。</li>
  <li>它是完全托管的，因此无需运营自己的容器存储库或担心底层基础架构的扩展。</li>
  <li>很安全。具有扫描功能和基于角色的访问控制的私有容器注册表提供了更多的安全性、治理(IAM)和高效管理。它通过HTTPS传输您的容器图像，并自动加密您的静态图像。</li>
  <li>在运行容器的系统附近运行注册中心可以减少部署延迟并减少网络中断的风险。</li>
</ul>

<p>开发人员需要使用注册表来存储应用程序开发过程中创建的图像。<a href="https://circleci.com/continuous-integration/">持续集成</a>管道连接构建容器图像，并将这些工件推入亚马逊ECR。想象一个管道，其中您推送一个commit，该commit触发CircleCI上的一个构建，该构建将一个新图像推送到Amazon ECR中。然后，您的注册中心可以启动webhook并触发部署。所有这些都不需要人工做任何事情。注册中心使得这种完全自动化的管道更加容易。放在注册表中的容器映像可以在开发的不同阶段使用。在几个步骤中，使用<a href="https://circleci.com/orbs/"> CircleCI orbs </a>，我们将封装一个简单的Node.js应用程序，构建映像，并将其推送到Amazon ECR。</p>

<h2>设置Amazon ECR</h2>

<p>从AWS管理控制台中，选择IAM。此服务允许您管理对AWS资源的访问。</p>

<p><img src="../Images/cdd9411739df9a09b4cd731f29cb5537.png" alt="AWS management console" class="zoomable" srcset="https://ctf-cci-com.imgix.net/4iN4jYnW4RDsTxEICyxEG2/94f1754f97c75562b586f58f08658aa2/2023-02-16-management-console.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=449 449w,&#10;https://ctf-cci-com.imgix.net/4iN4jYnW4RDsTxEICyxEG2/94f1754f97c75562b586f58f08658aa2/2023-02-16-management-console.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=898 898w,&#10;https://ctf-cci-com.imgix.net/4iN4jYnW4RDsTxEICyxEG2/94f1754f97c75562b586f58f08658aa2/2023-02-16-management-console.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=1347 1347w,&#10;https://ctf-cci-com.imgix.net/4iN4jYnW4RDsTxEICyxEG2/94f1754f97c75562b586f58f08658aa2/2023-02-16-management-console.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=720 720w,&#10;https://ctf-cci-com.imgix.net/4iN4jYnW4RDsTxEICyxEG2/94f1754f97c75562b586f58f08658aa2/2023-02-16-management-console.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=1440 1440w,&#10;https://ctf-cci-com.imgix.net/4iN4jYnW4RDsTxEICyxEG2/94f1754f97c75562b586f58f08658aa2/2023-02-16-management-console.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=2160 2160w,&#10;https://ctf-cci-com.imgix.net/4iN4jYnW4RDsTxEICyxEG2/94f1754f97c75562b586f58f08658aa2/2023-02-16-management-console.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=720 720w,&#10;https://ctf-cci-com.imgix.net/4iN4jYnW4RDsTxEICyxEG2/94f1754f97c75562b586f58f08658aa2/2023-02-16-management-console.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=1440 1440w,&#10;https://ctf-cci-com.imgix.net/4iN4jYnW4RDsTxEICyxEG2/94f1754f97c75562b586f58f08658aa2/2023-02-16-management-console.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=2160 2160w,&#10;https://ctf-cci-com.imgix.net/4iN4jYnW4RDsTxEICyxEG2/94f1754f97c75562b586f58f08658aa2/2023-02-16-management-console.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=779 779w,&#10;https://ctf-cci-com.imgix.net/4iN4jYnW4RDsTxEICyxEG2/94f1754f97c75562b586f58f08658aa2/2023-02-16-management-console.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=1558 1558w,&#10;https://ctf-cci-com.imgix.net/4iN4jYnW4RDsTxEICyxEG2/94f1754f97c75562b586f58f08658aa2/2023-02-16-management-console.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=2337 2337w,&#10;https://ctf-cci-com.imgix.net/4iN4jYnW4RDsTxEICyxEG2/94f1754f97c75562b586f58f08658aa2/2023-02-16-management-console.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=750 750w,&#10;https://ctf-cci-com.imgix.net/4iN4jYnW4RDsTxEICyxEG2/94f1754f97c75562b586f58f08658aa2/2023-02-16-management-console.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=1500 1500w,&#10;https://ctf-cci-com.imgix.net/4iN4jYnW4RDsTxEICyxEG2/94f1754f97c75562b586f58f08658aa2/2023-02-16-management-console.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=2250 2250w" sizes="(min-width: 1200px) 750px,&#10;(min-width: 992px) 779px,&#10;(min-width: 768px) 720px,&#10;(min-width: 480px) 720px,&#10;(min-width: 0px) 449px" data-full-size-src="https://ctf-cci-com.imgix.net/4iN4jYnW4RDsTxEICyxEG2/94f1754f97c75562b586f58f08658aa2/2023-02-16-management-console.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;fm=jpg" data-original-src="https://images.ctfassets.net/il1yandlcjgk/4iN4jYnW4RDsTxEICyxEG2/94f1754f97c75562b586f58f08658aa2/2023-02-16-management-console.png"/></p>

<p>创建角色/用户。我把我的名字叫做<code>ci-cd-ecr</code>，但是任何名字都可以。确保您选择了<strong>访问键-编程访问</strong>选项。</p>

<p><img src="../Images/e66e8d82a4688addee7dc53705f4ec16.png" alt="Create role/user" class="zoomable" srcset="https://ctf-cci-com.imgix.net/4JXd0G0dqhEsJam153R4Qb/15a7a99c444aac0afac77cf09b126c96/2023-02-16-create-role.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=449 449w,&#10;https://ctf-cci-com.imgix.net/4JXd0G0dqhEsJam153R4Qb/15a7a99c444aac0afac77cf09b126c96/2023-02-16-create-role.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=898 898w,&#10;https://ctf-cci-com.imgix.net/4JXd0G0dqhEsJam153R4Qb/15a7a99c444aac0afac77cf09b126c96/2023-02-16-create-role.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=1347 1347w,&#10;https://ctf-cci-com.imgix.net/4JXd0G0dqhEsJam153R4Qb/15a7a99c444aac0afac77cf09b126c96/2023-02-16-create-role.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=720 720w,&#10;https://ctf-cci-com.imgix.net/4JXd0G0dqhEsJam153R4Qb/15a7a99c444aac0afac77cf09b126c96/2023-02-16-create-role.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=1440 1440w,&#10;https://ctf-cci-com.imgix.net/4JXd0G0dqhEsJam153R4Qb/15a7a99c444aac0afac77cf09b126c96/2023-02-16-create-role.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=2160 2160w,&#10;https://ctf-cci-com.imgix.net/4JXd0G0dqhEsJam153R4Qb/15a7a99c444aac0afac77cf09b126c96/2023-02-16-create-role.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=720 720w,&#10;https://ctf-cci-com.imgix.net/4JXd0G0dqhEsJam153R4Qb/15a7a99c444aac0afac77cf09b126c96/2023-02-16-create-role.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=1440 1440w,&#10;https://ctf-cci-com.imgix.net/4JXd0G0dqhEsJam153R4Qb/15a7a99c444aac0afac77cf09b126c96/2023-02-16-create-role.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=2160 2160w,&#10;https://ctf-cci-com.imgix.net/4JXd0G0dqhEsJam153R4Qb/15a7a99c444aac0afac77cf09b126c96/2023-02-16-create-role.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=779 779w,&#10;https://ctf-cci-com.imgix.net/4JXd0G0dqhEsJam153R4Qb/15a7a99c444aac0afac77cf09b126c96/2023-02-16-create-role.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=1558 1558w,&#10;https://ctf-cci-com.imgix.net/4JXd0G0dqhEsJam153R4Qb/15a7a99c444aac0afac77cf09b126c96/2023-02-16-create-role.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=2337 2337w,&#10;https://ctf-cci-com.imgix.net/4JXd0G0dqhEsJam153R4Qb/15a7a99c444aac0afac77cf09b126c96/2023-02-16-create-role.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=750 750w,&#10;https://ctf-cci-com.imgix.net/4JXd0G0dqhEsJam153R4Qb/15a7a99c444aac0afac77cf09b126c96/2023-02-16-create-role.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=1500 1500w,&#10;https://ctf-cci-com.imgix.net/4JXd0G0dqhEsJam153R4Qb/15a7a99c444aac0afac77cf09b126c96/2023-02-16-create-role.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=2250 2250w" sizes="(min-width: 1200px) 750px,&#10;(min-width: 992px) 779px,&#10;(min-width: 768px) 720px,&#10;(min-width: 480px) 720px,&#10;(min-width: 0px) 449px" data-full-size-src="https://ctf-cci-com.imgix.net/4JXd0G0dqhEsJam153R4Qb/15a7a99c444aac0afac77cf09b126c96/2023-02-16-create-role.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;fm=jpg" data-original-src="https://images.ctfassets.net/il1yandlcjgk/4JXd0G0dqhEsJam153R4Qb/15a7a99c444aac0afac77cf09b126c96/2023-02-16-create-role.png"/></p>

<p>接下来，为用户设置权限。点击<strong>直接附加已有保单</strong>。这个截屏显示了在AWS上成功地为您的图像创建一个私有存储库并拥有其他修改的完全访问权限所需的内容。</p>

<p><img src="../Images/3063ac2938138c00d8a8c697fe6f95d8.png" alt="Set permission" class="zoomable" srcset="https://ctf-cci-com.imgix.net/2GbHFTj8xw2LDWx4aPCjh0/1ef1de9e062ed700edef14133073202b/2023-02-16-set-permissions.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=449 449w,&#10;https://ctf-cci-com.imgix.net/2GbHFTj8xw2LDWx4aPCjh0/1ef1de9e062ed700edef14133073202b/2023-02-16-set-permissions.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=898 898w,&#10;https://ctf-cci-com.imgix.net/2GbHFTj8xw2LDWx4aPCjh0/1ef1de9e062ed700edef14133073202b/2023-02-16-set-permissions.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=1347 1347w,&#10;https://ctf-cci-com.imgix.net/2GbHFTj8xw2LDWx4aPCjh0/1ef1de9e062ed700edef14133073202b/2023-02-16-set-permissions.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=720 720w,&#10;https://ctf-cci-com.imgix.net/2GbHFTj8xw2LDWx4aPCjh0/1ef1de9e062ed700edef14133073202b/2023-02-16-set-permissions.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=1440 1440w,&#10;https://ctf-cci-com.imgix.net/2GbHFTj8xw2LDWx4aPCjh0/1ef1de9e062ed700edef14133073202b/2023-02-16-set-permissions.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=2160 2160w,&#10;https://ctf-cci-com.imgix.net/2GbHFTj8xw2LDWx4aPCjh0/1ef1de9e062ed700edef14133073202b/2023-02-16-set-permissions.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=720 720w,&#10;https://ctf-cci-com.imgix.net/2GbHFTj8xw2LDWx4aPCjh0/1ef1de9e062ed700edef14133073202b/2023-02-16-set-permissions.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=1440 1440w,&#10;https://ctf-cci-com.imgix.net/2GbHFTj8xw2LDWx4aPCjh0/1ef1de9e062ed700edef14133073202b/2023-02-16-set-permissions.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=2160 2160w,&#10;https://ctf-cci-com.imgix.net/2GbHFTj8xw2LDWx4aPCjh0/1ef1de9e062ed700edef14133073202b/2023-02-16-set-permissions.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=779 779w,&#10;https://ctf-cci-com.imgix.net/2GbHFTj8xw2LDWx4aPCjh0/1ef1de9e062ed700edef14133073202b/2023-02-16-set-permissions.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=1558 1558w,&#10;https://ctf-cci-com.imgix.net/2GbHFTj8xw2LDWx4aPCjh0/1ef1de9e062ed700edef14133073202b/2023-02-16-set-permissions.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=2337 2337w,&#10;https://ctf-cci-com.imgix.net/2GbHFTj8xw2LDWx4aPCjh0/1ef1de9e062ed700edef14133073202b/2023-02-16-set-permissions.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=750 750w,&#10;https://ctf-cci-com.imgix.net/2GbHFTj8xw2LDWx4aPCjh0/1ef1de9e062ed700edef14133073202b/2023-02-16-set-permissions.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=1500 1500w,&#10;https://ctf-cci-com.imgix.net/2GbHFTj8xw2LDWx4aPCjh0/1ef1de9e062ed700edef14133073202b/2023-02-16-set-permissions.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=2250 2250w" sizes="(min-width: 1200px) 750px,&#10;(min-width: 992px) 779px,&#10;(min-width: 768px) 720px,&#10;(min-width: 480px) 720px,&#10;(min-width: 0px) 449px" data-full-size-src="https://ctf-cci-com.imgix.net/2GbHFTj8xw2LDWx4aPCjh0/1ef1de9e062ed700edef14133073202b/2023-02-16-set-permissions.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;fm=jpg" data-original-src="https://images.ctfassets.net/il1yandlcjgk/2GbHFTj8xw2LDWx4aPCjh0/1ef1de9e062ed700edef14133073202b/2023-02-16-set-permissions.png"/></p>

<p>点击<strong>下一个</strong>两次，创建新用户。</p>

<p>您将收到一条成功消息以及您的用户凭据。该页面只显示一次，因此请记下<strong>访问密钥ID </strong>和<strong>秘密访问密钥</strong>，稍后将会用到。或者，您可以下载提供的包含相同凭据的csv文件。</p>

<p><img src="../Images/b9ad00bb9c29bc613be0d0b6cfdc142d.png" alt="User credentials" class="zoomable" srcset="https://ctf-cci-com.imgix.net/1XSsR0JxsSkuywCF3S6zzV/489abb1d6123f8ee21f23769c0f32193/2023-02-16-user-credentials.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=449 449w,&#10;https://ctf-cci-com.imgix.net/1XSsR0JxsSkuywCF3S6zzV/489abb1d6123f8ee21f23769c0f32193/2023-02-16-user-credentials.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=898 898w,&#10;https://ctf-cci-com.imgix.net/1XSsR0JxsSkuywCF3S6zzV/489abb1d6123f8ee21f23769c0f32193/2023-02-16-user-credentials.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=1347 1347w,&#10;https://ctf-cci-com.imgix.net/1XSsR0JxsSkuywCF3S6zzV/489abb1d6123f8ee21f23769c0f32193/2023-02-16-user-credentials.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=720 720w,&#10;https://ctf-cci-com.imgix.net/1XSsR0JxsSkuywCF3S6zzV/489abb1d6123f8ee21f23769c0f32193/2023-02-16-user-credentials.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=1440 1440w,&#10;https://ctf-cci-com.imgix.net/1XSsR0JxsSkuywCF3S6zzV/489abb1d6123f8ee21f23769c0f32193/2023-02-16-user-credentials.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=2160 2160w,&#10;https://ctf-cci-com.imgix.net/1XSsR0JxsSkuywCF3S6zzV/489abb1d6123f8ee21f23769c0f32193/2023-02-16-user-credentials.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=720 720w,&#10;https://ctf-cci-com.imgix.net/1XSsR0JxsSkuywCF3S6zzV/489abb1d6123f8ee21f23769c0f32193/2023-02-16-user-credentials.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=1440 1440w,&#10;https://ctf-cci-com.imgix.net/1XSsR0JxsSkuywCF3S6zzV/489abb1d6123f8ee21f23769c0f32193/2023-02-16-user-credentials.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=2160 2160w,&#10;https://ctf-cci-com.imgix.net/1XSsR0JxsSkuywCF3S6zzV/489abb1d6123f8ee21f23769c0f32193/2023-02-16-user-credentials.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=779 779w,&#10;https://ctf-cci-com.imgix.net/1XSsR0JxsSkuywCF3S6zzV/489abb1d6123f8ee21f23769c0f32193/2023-02-16-user-credentials.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=1558 1558w,&#10;https://ctf-cci-com.imgix.net/1XSsR0JxsSkuywCF3S6zzV/489abb1d6123f8ee21f23769c0f32193/2023-02-16-user-credentials.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=2337 2337w,&#10;https://ctf-cci-com.imgix.net/1XSsR0JxsSkuywCF3S6zzV/489abb1d6123f8ee21f23769c0f32193/2023-02-16-user-credentials.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=750 750w,&#10;https://ctf-cci-com.imgix.net/1XSsR0JxsSkuywCF3S6zzV/489abb1d6123f8ee21f23769c0f32193/2023-02-16-user-credentials.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=1500 1500w,&#10;https://ctf-cci-com.imgix.net/1XSsR0JxsSkuywCF3S6zzV/489abb1d6123f8ee21f23769c0f32193/2023-02-16-user-credentials.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=2250 2250w" sizes="(min-width: 1200px) 750px,&#10;(min-width: 992px) 779px,&#10;(min-width: 768px) 720px,&#10;(min-width: 480px) 720px,&#10;(min-width: 0px) 449px" data-full-size-src="https://ctf-cci-com.imgix.net/1XSsR0JxsSkuywCF3S6zzV/489abb1d6123f8ee21f23769c0f32193/2023-02-16-user-credentials.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;fm=jpg" data-original-src="https://images.ctfassets.net/il1yandlcjgk/1XSsR0JxsSkuywCF3S6zzV/489abb1d6123f8ee21f23769c0f32193/2023-02-16-user-credentials.png"/></p>

<h2>使用AWS-ECR orb设置CircleCI管道</h2>

<p>这个演示的代码可以在GitHub <a href="https://github.com/CIRCLECI-GWP/circleci-ecr-demo" target="_blank" rel="noreferrer noopener">这里</a>找到。使用以下命令克隆应用程序:</p>

<pre><code class="language-bash">git clone https://github.com/CIRCLECI-GWP/circleci-ecr-demo
</code></pre>

<p>在<code>.circleci/</code>文件夹中找到CircleCI配置文件。使用orbs，正如您将看到的，您可以构建一个映像并将其推送到Amazon ECR，只需13行配置！aws-ecr orb预装了以下命令:</p>

<ul>
  <li>建立形象</li>
  <li>登录亚马逊ECR</li>
  <li>创建一个Amazon ECR repo(如果不存在)</li>
  <li>将图片推送到亚马逊ECR</li>
</ul>

<p>以下是您的管道的完整配置:</p>

<pre><code class="language-yml">version: 2.1

orbs:
  aws-ecr: circleci/aws-ecr@8.1.3

workflows:
  build_and_push_image:
    jobs:
      - aws-ecr/build-and-push-image:
          context: aws-dev
          create-repo: true
          dockerfile: Dockerfile
          path: .
          repo: circleci-ecr-demo
          tag: "$CIRCLE_SHA1"
</code></pre>

<p>这个配置文件使用<a href="https://circleci.com/developer/orbs/orb/circleci/aws-ecr"> Amazon弹性容器注册中心</a> orb来构建和部署Docker映像。<code>dockerfile:</code>命令指定docker文件的路径。演示报告使用以下Dockerfile文件:</p>

<pre><code># Set the base image to use for subsequent instructions
FROM node:alpine

# Add metadata to an image
LABEL app="simple-node-application"
# Directive to set environmental variables key to value pair
ENV NPM_CONFIG_LOGLEVEL warn

# Set the working directory for any subsequent ADD, COPY, CMD, ENTRYPOINT,
# or RUN instructions that follow it in the Dockerfile
WORKDIR /usr/src/app

# Copy files or folders from source to the dest path in the image's filesystem.
COPY package.json /usr/src/app/
COPY . /usr/src/app/

# Execute any commands on top of the current image as a new layer and commit the results.
RUN npm install --production

# Define the network ports that this container will listen on at runtime.
EXPOSE 3000

# Configure the container to be run as an executable.
ENTRYPOINT ["npm", "start"]
</code></pre>

<h2>为Amazon ECR添加上下文和设置环境变量</h2>

<p>在您的CircleCI仪表板中，通过单击侧边栏中的链接进入组织设置页面。接下来，选择<strong>上下文</strong>。点击<strong>创建上下文</strong>按钮，为您的上下文添加一个唯一的名称。该上下文出现在安全性设置为<code>All members</code>的列表中，表示组织中的任何人都可以在运行时访问该上下文。正如本教程的<code>.circleci/config.yml</code>配置中所指定的，上下文名称应该是<code>aws-dev</code>。</p>

<p><img src="../Images/ec722f3236abe3b5eb86f143e6a4ebb8.png" alt="Create Contexts" class="zoomable" srcset="https://ctf-cci-com.imgix.net/2wy0v6gtQfpeskQBySV2AH/49715d7d91b7215852897c4d140add6f/2023-02-16-create-context.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=449 449w,&#10;https://ctf-cci-com.imgix.net/2wy0v6gtQfpeskQBySV2AH/49715d7d91b7215852897c4d140add6f/2023-02-16-create-context.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=898 898w,&#10;https://ctf-cci-com.imgix.net/2wy0v6gtQfpeskQBySV2AH/49715d7d91b7215852897c4d140add6f/2023-02-16-create-context.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=1347 1347w,&#10;https://ctf-cci-com.imgix.net/2wy0v6gtQfpeskQBySV2AH/49715d7d91b7215852897c4d140add6f/2023-02-16-create-context.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=720 720w,&#10;https://ctf-cci-com.imgix.net/2wy0v6gtQfpeskQBySV2AH/49715d7d91b7215852897c4d140add6f/2023-02-16-create-context.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=1440 1440w,&#10;https://ctf-cci-com.imgix.net/2wy0v6gtQfpeskQBySV2AH/49715d7d91b7215852897c4d140add6f/2023-02-16-create-context.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=2160 2160w,&#10;https://ctf-cci-com.imgix.net/2wy0v6gtQfpeskQBySV2AH/49715d7d91b7215852897c4d140add6f/2023-02-16-create-context.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=720 720w,&#10;https://ctf-cci-com.imgix.net/2wy0v6gtQfpeskQBySV2AH/49715d7d91b7215852897c4d140add6f/2023-02-16-create-context.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=1440 1440w,&#10;https://ctf-cci-com.imgix.net/2wy0v6gtQfpeskQBySV2AH/49715d7d91b7215852897c4d140add6f/2023-02-16-create-context.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=2160 2160w,&#10;https://ctf-cci-com.imgix.net/2wy0v6gtQfpeskQBySV2AH/49715d7d91b7215852897c4d140add6f/2023-02-16-create-context.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=779 779w,&#10;https://ctf-cci-com.imgix.net/2wy0v6gtQfpeskQBySV2AH/49715d7d91b7215852897c4d140add6f/2023-02-16-create-context.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=1558 1558w,&#10;https://ctf-cci-com.imgix.net/2wy0v6gtQfpeskQBySV2AH/49715d7d91b7215852897c4d140add6f/2023-02-16-create-context.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=2337 2337w,&#10;https://ctf-cci-com.imgix.net/2wy0v6gtQfpeskQBySV2AH/49715d7d91b7215852897c4d140add6f/2023-02-16-create-context.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=750 750w,&#10;https://ctf-cci-com.imgix.net/2wy0v6gtQfpeskQBySV2AH/49715d7d91b7215852897c4d140add6f/2023-02-16-create-context.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=1500 1500w,&#10;https://ctf-cci-com.imgix.net/2wy0v6gtQfpeskQBySV2AH/49715d7d91b7215852897c4d140add6f/2023-02-16-create-context.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=2250 2250w" sizes="(min-width: 1200px) 750px,&#10;(min-width: 992px) 779px,&#10;(min-width: 768px) 720px,&#10;(min-width: 480px) 720px,&#10;(min-width: 0px) 449px" data-full-size-src="https://ctf-cci-com.imgix.net/2wy0v6gtQfpeskQBySV2AH/49715d7d91b7215852897c4d140add6f/2023-02-16-create-context.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;fm=jpg" data-original-src="https://images.ctfassets.net/il1yandlcjgk/2wy0v6gtQfpeskQBySV2AH/49715d7d91b7215852897c4d140add6f/2023-02-16-create-context.png"/></p>

<p>接下来，选择aws-credentials上下文。</p>

<p><img src="../Images/85f31111f7f30127f08de19751b15800.png" alt="Create environment variables" class="zoomable" srcset="https://ctf-cci-com.imgix.net/33oP2bH2OZd2S5KaMf1exG/38c6c4cc16e8dc116356e4423275c58f/2023-02-16-create-environment-variables.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=449 449w,&#10;https://ctf-cci-com.imgix.net/33oP2bH2OZd2S5KaMf1exG/38c6c4cc16e8dc116356e4423275c58f/2023-02-16-create-environment-variables.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=898 898w,&#10;https://ctf-cci-com.imgix.net/33oP2bH2OZd2S5KaMf1exG/38c6c4cc16e8dc116356e4423275c58f/2023-02-16-create-environment-variables.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=1347 1347w,&#10;https://ctf-cci-com.imgix.net/33oP2bH2OZd2S5KaMf1exG/38c6c4cc16e8dc116356e4423275c58f/2023-02-16-create-environment-variables.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=720 720w,&#10;https://ctf-cci-com.imgix.net/33oP2bH2OZd2S5KaMf1exG/38c6c4cc16e8dc116356e4423275c58f/2023-02-16-create-environment-variables.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=1440 1440w,&#10;https://ctf-cci-com.imgix.net/33oP2bH2OZd2S5KaMf1exG/38c6c4cc16e8dc116356e4423275c58f/2023-02-16-create-environment-variables.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=2160 2160w,&#10;https://ctf-cci-com.imgix.net/33oP2bH2OZd2S5KaMf1exG/38c6c4cc16e8dc116356e4423275c58f/2023-02-16-create-environment-variables.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=720 720w,&#10;https://ctf-cci-com.imgix.net/33oP2bH2OZd2S5KaMf1exG/38c6c4cc16e8dc116356e4423275c58f/2023-02-16-create-environment-variables.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=1440 1440w,&#10;https://ctf-cci-com.imgix.net/33oP2bH2OZd2S5KaMf1exG/38c6c4cc16e8dc116356e4423275c58f/2023-02-16-create-environment-variables.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=2160 2160w,&#10;https://ctf-cci-com.imgix.net/33oP2bH2OZd2S5KaMf1exG/38c6c4cc16e8dc116356e4423275c58f/2023-02-16-create-environment-variables.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=779 779w,&#10;https://ctf-cci-com.imgix.net/33oP2bH2OZd2S5KaMf1exG/38c6c4cc16e8dc116356e4423275c58f/2023-02-16-create-environment-variables.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=1558 1558w,&#10;https://ctf-cci-com.imgix.net/33oP2bH2OZd2S5KaMf1exG/38c6c4cc16e8dc116356e4423275c58f/2023-02-16-create-environment-variables.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=2337 2337w,&#10;https://ctf-cci-com.imgix.net/33oP2bH2OZd2S5KaMf1exG/38c6c4cc16e8dc116356e4423275c58f/2023-02-16-create-environment-variables.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=750 750w,&#10;https://ctf-cci-com.imgix.net/33oP2bH2OZd2S5KaMf1exG/38c6c4cc16e8dc116356e4423275c58f/2023-02-16-create-environment-variables.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=1500 1500w,&#10;https://ctf-cci-com.imgix.net/33oP2bH2OZd2S5KaMf1exG/38c6c4cc16e8dc116356e4423275c58f/2023-02-16-create-environment-variables.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=2250 2250w" sizes="(min-width: 1200px) 750px,&#10;(min-width: 992px) 779px,&#10;(min-width: 768px) 720px,&#10;(min-width: 480px) 720px,&#10;(min-width: 0px) 449px" data-full-size-src="https://ctf-cci-com.imgix.net/33oP2bH2OZd2S5KaMf1exG/38c6c4cc16e8dc116356e4423275c58f/2023-02-16-create-environment-variables.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;fm=jpg" data-original-src="https://images.ctfassets.net/il1yandlcjgk/33oP2bH2OZd2S5KaMf1exG/38c6c4cc16e8dc116356e4423275c58f/2023-02-16-create-environment-variables.png"/></p>

<p>点击<strong>添加环境变量</strong>按钮。输入要与此上下文关联的变量名和值。点击<strong>添加变量</strong>按钮保存。<code>aws-dev</code>上下文需要这三个环境变量:</p>

<ul>
  <li><code>AWS_ACCESS_KEY_ID</code>是您之前创建的<code>ci-cd-ecr</code> IAM角色的AWS访问键id。</li>
  <li><code>AWS_SECRET_ACCESS_KEY</code>是您之前创建的<code>ci-cd-ecr</code> IAM角色的AWS密钥。</li>
  <li><code>AWS_ECR_REGISTRY_ID</code>是与ECR账户相关的12位AWS id。这也称为帐户ID。</li>
  <li><code>AWS_REGION</code>是您的ECR资源所在的AWS区域。</li>
</ul>

<p><strong>注意:</strong> <i>你不必设置<code>$CIRCLE_SHA1</code>，因为它是所有CircleCI项目中可用的默认变量。这是当前构建的最后一次提交的<code>SHA1</code>散列。使用Git提交散列让您能够跟踪容器中的内容。理想情况下，它允许您将容器追溯到其Docker映像，然后追溯到映像中包含的Docker文件和代码。在自动化执行环境中，这将带您回到导致Docker映像构建的提交。</i></p>

<h2>将应用程序连接到CircleCI</h2>

<p>下一步是在GitHub上建立一个资源库，并将项目链接到CircleCI。查看<a href="https://circleci.com/blog/pushing-a-project-to-github/">将项目推送到GitHub </a>以获取指示。</p>

<p>登录您的CircleCI帐户。如果你注册了你的GitHub账户，你所有的库都可以在你项目的仪表盘上看到。找到您的项目(本例中为<code>circleci-ecr-demo</code>)并点击<strong>设置项目</strong>。</p>

<p><img src="../Images/bff606e9722f6413fc1ebd161af2b041.png" alt="Select project" class="zoomable" srcset="https://ctf-cci-com.imgix.net/6hUba7ugZpyJatEHbEYSRh/db93b7cfa0c76b6b22432ba308eb0cfd/2023-02-16-select-project.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=449 449w,&#10;https://ctf-cci-com.imgix.net/6hUba7ugZpyJatEHbEYSRh/db93b7cfa0c76b6b22432ba308eb0cfd/2023-02-16-select-project.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=898 898w,&#10;https://ctf-cci-com.imgix.net/6hUba7ugZpyJatEHbEYSRh/db93b7cfa0c76b6b22432ba308eb0cfd/2023-02-16-select-project.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=1347 1347w,&#10;https://ctf-cci-com.imgix.net/6hUba7ugZpyJatEHbEYSRh/db93b7cfa0c76b6b22432ba308eb0cfd/2023-02-16-select-project.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=720 720w,&#10;https://ctf-cci-com.imgix.net/6hUba7ugZpyJatEHbEYSRh/db93b7cfa0c76b6b22432ba308eb0cfd/2023-02-16-select-project.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=1440 1440w,&#10;https://ctf-cci-com.imgix.net/6hUba7ugZpyJatEHbEYSRh/db93b7cfa0c76b6b22432ba308eb0cfd/2023-02-16-select-project.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=2160 2160w,&#10;https://ctf-cci-com.imgix.net/6hUba7ugZpyJatEHbEYSRh/db93b7cfa0c76b6b22432ba308eb0cfd/2023-02-16-select-project.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=720 720w,&#10;https://ctf-cci-com.imgix.net/6hUba7ugZpyJatEHbEYSRh/db93b7cfa0c76b6b22432ba308eb0cfd/2023-02-16-select-project.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=1440 1440w,&#10;https://ctf-cci-com.imgix.net/6hUba7ugZpyJatEHbEYSRh/db93b7cfa0c76b6b22432ba308eb0cfd/2023-02-16-select-project.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=2160 2160w,&#10;https://ctf-cci-com.imgix.net/6hUba7ugZpyJatEHbEYSRh/db93b7cfa0c76b6b22432ba308eb0cfd/2023-02-16-select-project.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=779 779w,&#10;https://ctf-cci-com.imgix.net/6hUba7ugZpyJatEHbEYSRh/db93b7cfa0c76b6b22432ba308eb0cfd/2023-02-16-select-project.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=1558 1558w,&#10;https://ctf-cci-com.imgix.net/6hUba7ugZpyJatEHbEYSRh/db93b7cfa0c76b6b22432ba308eb0cfd/2023-02-16-select-project.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=2337 2337w,&#10;https://ctf-cci-com.imgix.net/6hUba7ugZpyJatEHbEYSRh/db93b7cfa0c76b6b22432ba308eb0cfd/2023-02-16-select-project.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=750 750w,&#10;https://ctf-cci-com.imgix.net/6hUba7ugZpyJatEHbEYSRh/db93b7cfa0c76b6b22432ba308eb0cfd/2023-02-16-select-project.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=1500 1500w,&#10;https://ctf-cci-com.imgix.net/6hUba7ugZpyJatEHbEYSRh/db93b7cfa0c76b6b22432ba308eb0cfd/2023-02-16-select-project.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=2250 2250w" sizes="(min-width: 1200px) 750px,&#10;(min-width: 992px) 779px,&#10;(min-width: 768px) 720px,&#10;(min-width: 480px) 720px,&#10;(min-width: 0px) 449px" data-full-size-src="https://ctf-cci-com.imgix.net/6hUba7ugZpyJatEHbEYSRh/db93b7cfa0c76b6b22432ba308eb0cfd/2023-02-16-select-project.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;fm=jpg" data-original-src="https://images.ctfassets.net/il1yandlcjgk/6hUba7ugZpyJatEHbEYSRh/db93b7cfa0c76b6b22432ba308eb0cfd/2023-02-16-select-project.png"/></p>

<p>在GitHub上输入您的代码所在的分支的名称，然后点击<strong>设置项目</strong>。</p>

<p>您的第一个工作流将开始运行并成功完成。</p>

<p><img src="../Images/9b6282891b194cd8db12ff8d9c413c12.png" alt="Build and deployed successfully" class="zoomable" srcset="https://ctf-cci-com.imgix.net/1NTYO3tVQMJWQOg0ceprNH/1ef01be7f8a880ea0b14d83fe0351196/2023-02-16-build-deploy-successful.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=449 449w,&#10;https://ctf-cci-com.imgix.net/1NTYO3tVQMJWQOg0ceprNH/1ef01be7f8a880ea0b14d83fe0351196/2023-02-16-build-deploy-successful.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=898 898w,&#10;https://ctf-cci-com.imgix.net/1NTYO3tVQMJWQOg0ceprNH/1ef01be7f8a880ea0b14d83fe0351196/2023-02-16-build-deploy-successful.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=1347 1347w,&#10;https://ctf-cci-com.imgix.net/1NTYO3tVQMJWQOg0ceprNH/1ef01be7f8a880ea0b14d83fe0351196/2023-02-16-build-deploy-successful.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=720 720w,&#10;https://ctf-cci-com.imgix.net/1NTYO3tVQMJWQOg0ceprNH/1ef01be7f8a880ea0b14d83fe0351196/2023-02-16-build-deploy-successful.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=1440 1440w,&#10;https://ctf-cci-com.imgix.net/1NTYO3tVQMJWQOg0ceprNH/1ef01be7f8a880ea0b14d83fe0351196/2023-02-16-build-deploy-successful.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=2160 2160w,&#10;https://ctf-cci-com.imgix.net/1NTYO3tVQMJWQOg0ceprNH/1ef01be7f8a880ea0b14d83fe0351196/2023-02-16-build-deploy-successful.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=720 720w,&#10;https://ctf-cci-com.imgix.net/1NTYO3tVQMJWQOg0ceprNH/1ef01be7f8a880ea0b14d83fe0351196/2023-02-16-build-deploy-successful.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=1440 1440w,&#10;https://ctf-cci-com.imgix.net/1NTYO3tVQMJWQOg0ceprNH/1ef01be7f8a880ea0b14d83fe0351196/2023-02-16-build-deploy-successful.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=2160 2160w,&#10;https://ctf-cci-com.imgix.net/1NTYO3tVQMJWQOg0ceprNH/1ef01be7f8a880ea0b14d83fe0351196/2023-02-16-build-deploy-successful.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=779 779w,&#10;https://ctf-cci-com.imgix.net/1NTYO3tVQMJWQOg0ceprNH/1ef01be7f8a880ea0b14d83fe0351196/2023-02-16-build-deploy-successful.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=1558 1558w,&#10;https://ctf-cci-com.imgix.net/1NTYO3tVQMJWQOg0ceprNH/1ef01be7f8a880ea0b14d83fe0351196/2023-02-16-build-deploy-successful.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=2337 2337w,&#10;https://ctf-cci-com.imgix.net/1NTYO3tVQMJWQOg0ceprNH/1ef01be7f8a880ea0b14d83fe0351196/2023-02-16-build-deploy-successful.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=750 750w,&#10;https://ctf-cci-com.imgix.net/1NTYO3tVQMJWQOg0ceprNH/1ef01be7f8a880ea0b14d83fe0351196/2023-02-16-build-deploy-successful.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=1500 1500w,&#10;https://ctf-cci-com.imgix.net/1NTYO3tVQMJWQOg0ceprNH/1ef01be7f8a880ea0b14d83fe0351196/2023-02-16-build-deploy-successful.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=2250 2250w" sizes="(min-width: 1200px) 750px,&#10;(min-width: 992px) 779px,&#10;(min-width: 768px) 720px,&#10;(min-width: 480px) 720px,&#10;(min-width: 0px) 449px" data-full-size-src="https://ctf-cci-com.imgix.net/1NTYO3tVQMJWQOg0ceprNH/1ef01be7f8a880ea0b14d83fe0351196/2023-02-16-build-deploy-successful.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;fm=jpg" data-original-src="https://images.ctfassets.net/il1yandlcjgk/1NTYO3tVQMJWQOg0ceprNH/1ef01be7f8a880ea0b14d83fe0351196/2023-02-16-build-deploy-successful.png"/></p>

<p>要查看存储库信息，请转到您的<a href="https://console.aws.amazon.com/ecr/repositories" target="_blank" rel="noreferrer noopener"> AWS管理控制台</a>。</p>

<h2>结论</h2>

<p>CircleCI和Amazon ECR都成功配置后，您就可以开始构建映像并将它们推送到存储库了。</p>

<p>只需几行代码，您就可以构建Docker图像并将其推送到Amazon ECR。CircleCI orbs通过将预构建的命令、作业和执行器导入CircleCI配置文件来节省时间，提供了与云服务和其他工具的轻松集成。</p>


        
          
          
            <hr/>
            <p>Dominic Motuka是Andela 的DevOps工程师，在AWS和GCP支持、自动化和优化生产就绪部署方面拥有4年多的实践经验，利用配置管理、CI/CD和DevOps流程。</p>

            <p><a href="/blog/author/dominic-motuka/" class="arrow-link">阅读多米尼克·莫图卡的更多帖子</a></p>
          
        
      </div>
    </div>    
</body>
</html>