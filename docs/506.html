<html>
<head>
<title>Run dbt tests in parallel with CI/CD | CircleCI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>与CI/CD | CircleCI并行运行dbt测试</h1>
<blockquote>原文：<a href="https://circleci.com/blog/run-dbt-tests-in-parallel/#2022-07-29T09:00:00-07:00">https://circleci.com/blog/run-dbt-tests-in-parallel/#2022-07-29T09:00:00-07:00</a></blockquote><div><div class="post-content col-xs-12 col-md-10 col-lg-8">
        

        <p>软件开发周期中的一个困难挑战是提高开发速度，同时确保代码质量保持不变。近年来，数据世界已经采用软件开发实践来测试部署前的数据更改。测试过程可能非常耗时，并且容易出现意外错误。</p>

<p>例如，在CircleCI，我们的数据团队在规模上使用<a href="https://www.getdbt.com/product/what-is-dbt/" target="_blank" rel="noreferrer noopener"> dbt </a>。直到最近，我们一直在经历由dbt云中的长时间测试运行导致的部署瓶颈。为了解决这个问题，我们建立了CircleCI来自动测试和部署我们的数据变更，以便我们能够尽快地向我们的数据消费者交付高质量的数据模型版本。在本帖中，我们将带您了解如何使用CircleCI和<a href="https://www.getdbt.com/product/what-is-dbt/" target="_blank" rel="noreferrer noopener"> dbt </a>根据生产副本自动测试您的数据更改，以确保数据完整性并提高您的开发速度。</p>

<p>本教程假设你是一个活跃的CircleCI用户。如果你是这个平台的新手，你可以<a href="https://circleci.com/signup/">注册一个免费账户</a>并按照我们的<a href="https://circleci.com/docs/getting-started-guide-experimental/">快速入门指南</a>进行设置。</p>

<h2>dbt是什么？</h2>

<p>dbt是一个数据转换工具，它允许数据人员将模块化的SQL与软件工程的最佳实践相结合，以实现可靠、迭代和快速的数据转换。您可以通过dbt CLI(命令行界面)或dbt Cloud与dbt进行交互。在CLI版本中，您可以完全控制您的数据项目配置，并能够根据需要发布文档，而dbt Cloud提供了一个用户界面，可以为您设置一些配置并自动生成dbt文档。</p>

<h2>为什么dbt在数据工程和分析中有用？</h2>

<p>dbt是一个强大的数据工具，允许您遍历表的变化，而无需手动修改UPSERT语句。您可以用模块化的方式编写SQL，并使用参数化查询或dbt提供的本机测试函数来配置数据测试。它有助于跟踪您的数据依赖性，并集中您的数据转换和文档，确保重要业务指标的单一来源。此外，它允许您在将数据发布到生产环境之前，测试您对数据的假设，以确保数据的完整性。</p>

<h2>dbt云中的并发问题</h2>

<p>通过使用dbt <a href="https://docs.getdbt.com/docs/dbt-cloud/using-dbt-cloud/cloud-enabling-continuous-integration#slim-ci" target="_blank" rel="noreferrer noopener"> slim CI函数</a>，您可以使用dbt Cloud为您的数据测试建立一个<a href="https://circleci.com/blog/what-is-a-ci-cd-pipeline/">持续集成和持续交付(CI/CD)管道</a>。您可以将它连接到您的GitLab或GitHub存储库，并配置测试作业在每个新的pull请求时触发。测试作业状态将直接出现在拉式请求中，以帮助您提高审核流程的效率。</p>

<p>但是，当前的dbt云CI/CD流程存在一些问题。首先，dbt Cloud CI/CD流程目前一次只允许一个作业，如果有多个拉请求合并到生产中，这会降低部署速度。它适用于只有一两个活跃dbt贡献者的小型数据团队，但当我们的分析部门开始扩展，分析师开始更频繁地贡献和部署dbt时，它就会显示出它的局限性。对于大型数据部署，它可能会使所有其他部署变慢一整天。</p>

<p>此外，当拉请求中有多个提交时，dbt云测试不能<a href="https://circleci.com/docs/skip-build/#auto-cancelling/">自动取消冗余工作流</a>，这会影响分析开发的测试速度。</p>

<h2>如何使用CircleCI并行运行dbt测试并启用自动取消</h2>

<p>通过使用CircleCI、dbt和雪花，针对生产数据运行并行dbt测试和自动取消冗余工作流变得可行。概括地说，这些步骤是:</p>

<ol>
  <li>为dbt CI作业创建一个dbt概要文件，以验证您的数据模型和测试。</li>
  <li>配置dbt来设置自定义模式，以允许pull请求在其各自的容器中运行数据模型和数据测试。</li>
  <li>在CircleCI中设置一个Python环境，为dbt测试做准备。</li>
  <li>在CircleCI中设置dbt运行和测试，以测试修改后的数据文件。</li>
</ol>

<h3>创建dbt概要文件</h3>

<p>首先，在<code>profiles.yml</code>中配置一个dbt-ci概要文件:</p>

<pre><code>circleci:
    # use user and password auth
    type: snowflake
    account: "nxa13674.us-east-1"
    user: "{{ env_var('DBT_DATA_MODELING_SNOWFLAKE_USER', 'not_set') }}"
    password: "{{ env_var('DBT_DATA_MODELING_SNOWFLAKE_PASSWORD', 'not_set') }}"
    role: "{{ env_var('DBT_DATA_MODELING_SNOWFLAKE_ROLE', 'not_set') }}"
    database: "{{ env_var('DBT_DATA_MODELING_SNOWFLAKE_DATABASE', 'not_set') }}"
    warehouse: "XSMALL_WAREHOUSE"
    schema: "public"
    query_tag: "circleci_dbt"
</code></pre>

<p>之后，转到CircleCI组织设置页面，设置一个<a href="https://circleci.com/docs/contexts/#creating-and-using-a-context/"> CircleCI上下文</a>，安全地共享项目中的环境变量。该上下文被命名为<code>dbt-ci-cd</code>，因此您可以在CircleCI YAML文件中引用它。</p>

<p><img src="../Images/81888eea404c779f83e19c19845548b2.png" alt="Setting up a context" class="zoomable" srcset="https://production-cci-com.imgix.net/blog/media/2022-07-29-dbt-testing-image3.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=449 449w,&#10;https://production-cci-com.imgix.net/blog/media/2022-07-29-dbt-testing-image3.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=898 898w,&#10;https://production-cci-com.imgix.net/blog/media/2022-07-29-dbt-testing-image3.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=1347 1347w,&#10;https://production-cci-com.imgix.net/blog/media/2022-07-29-dbt-testing-image3.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=720 720w,&#10;https://production-cci-com.imgix.net/blog/media/2022-07-29-dbt-testing-image3.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=1440 1440w,&#10;https://production-cci-com.imgix.net/blog/media/2022-07-29-dbt-testing-image3.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=2160 2160w,&#10;https://production-cci-com.imgix.net/blog/media/2022-07-29-dbt-testing-image3.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=720 720w,&#10;https://production-cci-com.imgix.net/blog/media/2022-07-29-dbt-testing-image3.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=1440 1440w,&#10;https://production-cci-com.imgix.net/blog/media/2022-07-29-dbt-testing-image3.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=2160 2160w,&#10;https://production-cci-com.imgix.net/blog/media/2022-07-29-dbt-testing-image3.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=779 779w,&#10;https://production-cci-com.imgix.net/blog/media/2022-07-29-dbt-testing-image3.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=1558 1558w,&#10;https://production-cci-com.imgix.net/blog/media/2022-07-29-dbt-testing-image3.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=2337 2337w,&#10;https://production-cci-com.imgix.net/blog/media/2022-07-29-dbt-testing-image3.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=750 750w,&#10;https://production-cci-com.imgix.net/blog/media/2022-07-29-dbt-testing-image3.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=1500 1500w,&#10;https://production-cci-com.imgix.net/blog/media/2022-07-29-dbt-testing-image3.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=2250 2250w" sizes="(min-width: 1200px) 750px,&#10;(min-width: 992px) 779px,&#10;(min-width: 768px) 720px,&#10;(min-width: 480px) 720px,&#10;(min-width: 0px) 449px" data-full-size-src="https://production-cci-com.imgix.net/blog/media/2022-07-29-dbt-testing-image3.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;fm=jpg" data-original-src="https://circleci.com/blog/media/2022-07-29-dbt-testing-image3.png"/></p>

<h3>在dbt中设置自定义模式</h3>

<p>接下来，设置一个<a href="https://docs.getdbt.com/docs/building-a-dbt-project/building-models/using-custom-schemas" target="_blank" rel="noreferrer noopener"> dbt定制模式</a>宏，以允许pull请求在容器化的环境中运行数据模型和数据测试:</p>

<ol>
  <li>在您的dbt项目的根目录中创建<code>macros/get_custom_schema.sql</code>来定制模式配置。</li>
  <li>在<code>get_custom_schema.sql</code>文件中复制并粘贴下面的代码:</li>
</ol>

<pre><code>{% macro generate_schema_name(custom_schema_name, node) -%}

   {%- set default_schema = target.schema -%}
   {%- if target.name == "circleci" -%}
       {# replace everything except letter and number in branch name to be underscore#}
       {% set re = modules.re %}
       {% set git_branch = modules.re.sub('[^a-zA-Z0-9]', '_', env_var('CIRCLE_BRANCH')).lower() %}
       {%- if custom_schema_name is none -%}
           z_pr_{{ git_branch }}_{{ default_schema }}
       {%- else -%}
           z_pr_{{ git_branch }}_{{default_schema}}_{{ custom_schema_name | trim }}
       {%- endif -%}
   {%- else -%}
       {%- if custom_schema_name is none -%}
           {{ default_schema }}
       {%- else -%}
           {{ custom_schema_name | trim }}
       {%- endif -%}
{%- endmacro -%}       
</code></pre>

<p>它将在CircleCI CI流程中使用标准模式格式<code>z_pr_&lt;the branch name&gt;_&lt;default schema&gt;</code>构建dbt数据模型，以将CI流程生成的数据模型容器化。</p>

<h3>配置CircleCI管道以测试dbt数据</h3>

<p>最后，为dbt配置CircleCI。</p>

<p>CircleCI的工作流程是在您的dbt项目根目录下的<code>.circleci/config.yml</code>下的<a href="https://circleci.com/blog/what-is-yaml-a-beginner-s-guide/"> YAML文件</a>中定义的。默认情况下，CircleCI会在每次提交到存储库时自动触发测试过程，也可以手动触发。以下是设置流程的步骤:</p>

<ol>
  <li>在您的dbt项目的根目录中创建<code>.circleci/config.yml</code></li>
  <li>复制并粘贴下面的YAML，以设置您的dbt CI流程。我们在CircleCI使用<a href="https://python-poetry.org/" target="_blank" rel="noreferrer noopener">poems</a>来管理我们的Python依赖，但是你可以使用任何你喜欢的Python依赖管理工具。dbt CI流程使用<a href="https://docs.getdbt.com/reference/node-selection/methods#the-state-method" target="_blank" rel="noreferrer noopener"> dbt的state:modified run方法</a>在生产环境中运行和测试修改后的dbt数据模型。</li>
</ol>

<pre><code>commands:
 setup-python-dependencies:
   description: Setup the python environment for testing and linting
   steps:
     - checkout:
         path: ~/project
     - restore_cache:
         keys:
           - v1-poetry-cache-{{ arch }}-{{ .Branch }}-{{ checksum "poetry.lock" }}
           - v1-poetry-cache-{{ arch }}-{{ .Branch }}
           - v1-poetry-cache
     - run: echo "export PATH=$HOME/.poetry/bin:$PATH" &gt;&gt; $BASH_ENV
     - run: curl -sSL https://raw.githubusercontent.com/python-poetry/poetry/master/get-poetry.py | python -
     - run: poetry install
     - save_cache:
         key: v1-poetry-cache-{{ arch }}-{{ .Branch }}-{{ checksum "poetry.lock" }}
         paths: /virtualenvs

jobs:
  dbt-build-ci:
	executor: python
	steps:
  	- setup-python-dependencies
  	- run: poetry run dbt deps --project-dir resources
  	- run:
      	name: compile dbt manifest in master branch
      	# use --target prod so the --defer will work correctly
      	command: |
        	git checkout master
        	poetry run dbt debug --project-dir resources --target prod
        	poetry run dbt compile --project-dir resources --target prod
        	mv resources/target/manifest.json .
  	- run: git checkout ${CIRCLE_BRANCH}
  	# separate run and test because "dbt build" will fail all downstream if upstream tests fail. We still want to see all tests results if the test failure is from production
  	# currently there is a version bug with state:modified.body, we will add state:modified.body back once we update dbt to be 1.0.4;
  	- run: poetry run dbt run --models state:modified --defer --state ~/project --exclude tag:skip-ci --project-dir resources -x
  	- run: poetry run dbt test --models state:modified --defer --state ~/project --exclude tag:skip-ci --project-dir resources

workflows:
  commit:
  	- dbt-build-ci:
      	context: dbt-ci-cd
      	filters:
        	branches:
          	ignore:
            	- master
</code></pre>

<h3>在CI/CD管道中运行并行dbt测试</h3>

<p>一旦您将您的变更推送到您的版本控制工具，CircleCI将自动为您启动测试过程。单个任务可以并行运行。</p>

<p><img src="../Images/c30089552986c5a437d939ab5e600fd1.png" alt="Tasks running in parallel" class="zoomable" srcset="https://production-cci-com.imgix.net/blog/media/2022-07-29-dbt-testing-image1.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=449 449w,&#10;https://production-cci-com.imgix.net/blog/media/2022-07-29-dbt-testing-image1.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=898 898w,&#10;https://production-cci-com.imgix.net/blog/media/2022-07-29-dbt-testing-image1.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=1347 1347w,&#10;https://production-cci-com.imgix.net/blog/media/2022-07-29-dbt-testing-image1.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=720 720w,&#10;https://production-cci-com.imgix.net/blog/media/2022-07-29-dbt-testing-image1.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=1440 1440w,&#10;https://production-cci-com.imgix.net/blog/media/2022-07-29-dbt-testing-image1.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=2160 2160w,&#10;https://production-cci-com.imgix.net/blog/media/2022-07-29-dbt-testing-image1.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=720 720w,&#10;https://production-cci-com.imgix.net/blog/media/2022-07-29-dbt-testing-image1.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=1440 1440w,&#10;https://production-cci-com.imgix.net/blog/media/2022-07-29-dbt-testing-image1.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=2160 2160w,&#10;https://production-cci-com.imgix.net/blog/media/2022-07-29-dbt-testing-image1.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=779 779w,&#10;https://production-cci-com.imgix.net/blog/media/2022-07-29-dbt-testing-image1.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=1558 1558w,&#10;https://production-cci-com.imgix.net/blog/media/2022-07-29-dbt-testing-image1.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=2337 2337w,&#10;https://production-cci-com.imgix.net/blog/media/2022-07-29-dbt-testing-image1.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=750 750w,&#10;https://production-cci-com.imgix.net/blog/media/2022-07-29-dbt-testing-image1.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=1500 1500w,&#10;https://production-cci-com.imgix.net/blog/media/2022-07-29-dbt-testing-image1.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=2250 2250w" sizes="(min-width: 1200px) 750px,&#10;(min-width: 992px) 779px,&#10;(min-width: 768px) 720px,&#10;(min-width: 480px) 720px,&#10;(min-width: 0px) 449px" data-full-size-src="https://production-cci-com.imgix.net/blog/media/2022-07-29-dbt-testing-image1.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;fm=jpg" data-original-src="https://circleci.com/blog/media/2022-07-29-dbt-testing-image1.png"/></p>

<p>现在你有一个成功的构建！</p>

<p><img src="../Images/c4bff53bc622f0a3f7379c63f3867474.png" alt="Build success" class="zoomable" srcset="https://production-cci-com.imgix.net/blog/media/2022-07-29-dbt-testing-image2.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=449 449w,&#10;https://production-cci-com.imgix.net/blog/media/2022-07-29-dbt-testing-image2.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=898 898w,&#10;https://production-cci-com.imgix.net/blog/media/2022-07-29-dbt-testing-image2.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=1347 1347w,&#10;https://production-cci-com.imgix.net/blog/media/2022-07-29-dbt-testing-image2.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=720 720w,&#10;https://production-cci-com.imgix.net/blog/media/2022-07-29-dbt-testing-image2.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=1440 1440w,&#10;https://production-cci-com.imgix.net/blog/media/2022-07-29-dbt-testing-image2.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=2160 2160w,&#10;https://production-cci-com.imgix.net/blog/media/2022-07-29-dbt-testing-image2.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=720 720w,&#10;https://production-cci-com.imgix.net/blog/media/2022-07-29-dbt-testing-image2.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=1440 1440w,&#10;https://production-cci-com.imgix.net/blog/media/2022-07-29-dbt-testing-image2.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=2160 2160w,&#10;https://production-cci-com.imgix.net/blog/media/2022-07-29-dbt-testing-image2.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=779 779w,&#10;https://production-cci-com.imgix.net/blog/media/2022-07-29-dbt-testing-image2.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=1558 1558w,&#10;https://production-cci-com.imgix.net/blog/media/2022-07-29-dbt-testing-image2.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=2337 2337w,&#10;https://production-cci-com.imgix.net/blog/media/2022-07-29-dbt-testing-image2.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=750 750w,&#10;https://production-cci-com.imgix.net/blog/media/2022-07-29-dbt-testing-image2.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=1500 1500w,&#10;https://production-cci-com.imgix.net/blog/media/2022-07-29-dbt-testing-image2.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;w=2250 2250w" sizes="(min-width: 1200px) 750px,&#10;(min-width: 992px) 779px,&#10;(min-width: 768px) 720px,&#10;(min-width: 480px) 720px,&#10;(min-width: 0px) 449px" data-full-size-src="https://production-cci-com.imgix.net/blog/media/2022-07-29-dbt-testing-image2.png?ixlib=rb-3.2.1&amp;auto=format&amp;fit=max&amp;q=60&amp;ch=DPR%2CWidth%2CViewport-Width%2CSave-Data&amp;fm=jpg" data-original-src="https://circleci.com/blog/media/2022-07-29-dbt-testing-image2.png"/></p>

<h2>结论</h2>

<p>您已经成功地在持续集成管道中设置了数据测试工作流！随着您的数据团队开始扩展，在发布到生产环境之前测试您的数据更改是一个重要的步骤。它帮助数据团队更快地迭代，并确保涉众对数据的信任。在持续集成管道中运行数据模型测试可以帮助您的数据团队扩展其工程和分析过程。</p>

<p>如果您有兴趣了解更多关于CircleCI的信息，并加入我们的数据团队，了解我们如何将软件开发流程应用于数据，请查看我们招聘页面上的<a href="https://circleci.com/careers/jobs/">空缺职位。</a></p>


        
          
          
        
      </div>
    </div>    
</body>
</html>